---
title: "Final Project"
author: "Estephani Barroso, Kassandra Chino Gonzalez, Yu-Fang Huang"
date: "2023-11-07"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Team members: 
Estephani Barroso, Kassandra Chino Gonzalez, Yu-Fang Huang

# Date set: 
COVID-19 Daily Counts of Cases

# url:
<https://data.cityofnewyork.us/api/views/rc75-m7u3/rows.csv?accessType=DOWNLOAD>

# Description of your data set: 
This data set counts the daily number of New York City residents who tested positive for COVID-19, were hospitalized with COVID-19, and the number of deaths among COVID-19 patients. This data set includes 67 variables and 1158 observations. These observations are recorded from 2/29/2020 to 5/1/2023. All of the variables are integer values. For the first few columns, it counts the daily number of cases and deaths in New York City, then counts the average seven days of those records. After that, it broke down into five different regions, which are Brooklyn (BK), Bronx (BX), Manhattan (MN), Queens (QU), and Staten Island (SI). Each region also counts the total cases and deaths and the average seven days of those cases.

# Questions: 
  -   Which of the five regions has the highest death in covid 19?
  -   On which day has the most COVID-19 cases?
  -   Which month in each year had the most cases in NYC? Most deaths?
  -   Visualization of NYC COVID-19 cases and deaths breakdown by year and then month in each year
  -   What is the average number of deaths and COVID-19 cases on a yearly, monthly, weekly basis in NYC?


```{r packages, message=FALSE}
library(readr)
library(tidyverse)
```
# Marginal summaries And Cleaning:

```{r}
Data <- read.csv("COVID.csv")

head(Data)
dim(Data) # 1158 observations and 67 variables
str(Data) # All integer variables with data being the only character variable 

missing_values <- colSums(is.na(Data))
missing_values #no missing values 


Final2 %>% summarise(TotalDeaths = sum(DEATH_COUNT), TotalCases = sum(CASE_COUNT))


Data$date_of_interest <- lubridate::mdy(Data$date_of_interest)


summary(Data)
Final <- Data %>%
  select(-contains("7DAY_AVG"))

Final2 <- Final %>%
  mutate(
    Year = year(date_of_interest),
    Month = month(date_of_interest, label = TRUE),
    Day = day(date_of_interest)
  )

New <- Final2 %>% 
  mutate(
    weekdays = wday(date_of_interest, label = TRUE)
  ) %>% 
  group_by(weekdays) 

```

# Total Deaths by Region
Which of the five regions has the highest death in covid 19?
  -   BK has the highest total deaths within the time frame of when this data was taken with a death count of 12107.
```{r}
# sum of death count in by region
RegionsTotalDeaths <- Final %>% 
  summarize(SI_DEATH = sum(SI_DEATH_COUNT),
            QN_DEATH =sum(QN_DEATH_COUNT),
            MN_DEATH = sum(MN_DEATH_COUNT),
            BK_DEATH = sum(BK_DEATH_COUNT),
            BX_DEATH = sum(BX_DEATH_COUNT))
RegionsTotalDeaths

# bar graph displaying death count in by region
barplot(c(RegionsTotalDeaths$BK_DEATH,
           RegionsTotalDeaths$QN_DEATH,
           RegionsTotalDeaths$BX_DEATH,
           RegionsTotalDeaths$MN_DEATH,
           RegionsTotalDeaths$SI_DEATH), 
        main = "Total Deaths in each Region", 
        xlab = "Region",
        ylim = c(0, max(RegionsTotalDeaths) + 1),
        ylab = "Death Count",
        names.arg = c("BK", "QN", "BX", "MN", "SI"),
        col = "coral",
        las = 1)
```
# Graphical Display of deaths and cases of COVID-19 per year

```{r}
ggplot(Final2, aes(x = factor(Year), y=DEATH_COUNT)) +
  geom_bar(stat = "identity", fill = "red", alpha = 0.7) +
  labs(title = "Deaths Per Year",
       x = "Year",
       y = "Deaths") + 
  theme(plot.title = element_text(hjust = 0.5))

ggplot(Final2, aes(x = factor(Year), y=CASE_COUNT)) +
  geom_bar(stat = "identity", fill = "purple", alpha = 0.7) +
  labs(title = "Cases Per Year",
       x = "Year",
       y = "Cases") + 
  theme(plot.title = element_text(hjust = 0.5))

```

# Graphical Display of deaths and cases of COVID-19 per month
  
```{r}
ggplot(Final2, aes(x = factor(Month), y=DEATH_COUNT)) +
  geom_bar(stat = "identity", fill = "red", alpha = 0.7) +
  labs(title = "Deaths Per Month",
       x = "Month",
       y = "Deaths")+ 
  theme(plot.title = element_text(hjust = 0.5))

ggplot(Final2, aes(x = factor(Month), y=CASE_COUNT)) +
  geom_bar(stat = "identity", fill = "purple", alpha = 0.7) +
  labs(title = "Cases Per Month",
       x = "Month",
       y = "Cases")+ 
  theme(plot.title = element_text(hjust = 0.5))
  
```

# Graphical Display of deaths and cases of COVID-19 per Month and Year

```{r}
# Cases per year 
ggplot(Final2, aes(x = factor(Month), y = DEATH_COUNT)) +
  geom_bar(stat = "identity", fill = "red", alpha = 0.7) +
  labs(title = "Deaths Per Month and Year",
       x = "Month",
       y = "Deaths") +
  facet_grid(~Year, scales = "free_x", space = "free_x") + 
  theme(plot.title = element_text(hjust = 0.5))

ggplot(Final2, aes(x = factor(Month), y = CASE_COUNT)) +
  geom_bar(stat = "identity", fill = "purple", alpha = 0.7) +
  labs(title = "Cases Per Month and Year",
       x = "Month",
       y = "Cases") +
  facet_grid(~Year, scales = "free_x", space = "free_x") + 
  theme(plot.title = element_text(hjust = 0.5))
```

# Graphical Display of deaths and cases of COVID-19 per day

```{r}
ggplot(Final2, aes(x = factor(Day), y = CASE_COUNT)) +
  geom_bar(stat = "identity", fill = "red", alpha = 0.7) +
  labs(title = "Cases per Day",
       x = "Day",
       y = "Cases") +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(Final2, aes(x = factor(Day), y = DEATH_COUNT)) +
  geom_bar(stat = "identity", fill = "red", alpha = 0.7) +
  labs(title = "Deaths Per Day",
       x = "Day",
       y = "Deaths") +
  theme(plot.title = element_text(hjust = 0.5))
```

# Graphical Display of deaths and cases of COVID-19 per weekday

```{r}
ggplot(New, aes(x=factor(weekdays), y = DEATH_COUNT)) +
  geom_bar(stat = "identity", fill = "red", alpha = 0.7) +
  labs(title = "Deaths Per Day",
       x = "Weekday",
       y = "Deaths") +
  theme(plot.title = element_text(hjust = 0.5))

ggplot(New, aes(x=factor(weekdays), y = CASE_COUNT)) +
  geom_bar(stat = "identity", fill = "purple", alpha = 0.7) +
  labs(title = "Cases Per Day",
       x = "Weekday",
       y = "Cases") +
  theme(plot.title = element_text(hjust = 0.5))

```

# Graphical Display of average deaths and cases of COVID-19 per year

```{r}
Final2$Year <- factor(Final2$Year, levels = c(2020, 2021, 2022, 2023))



ggplot(Final2, aes(x = factor(Year), y=mean(DEATH_COUNT))) +
  geom_bar(stat = "identity", fill = "orange", alpha = 0.7) +
  labs(title = "Average Deaths Per Year",
       x = "Year",
       y = "Deaths")      

ggplot(Final2, aes(x = factor(Year), y=mean(CASE_COUNT))) +
  geom_bar(stat = "identity", fill = "orange", alpha = 0.7) +
  labs(title = "Average Cases Per Year",
       x = "Year",
       y = "Cases")    
```

# Graphical Display of average deaths and cases of COVID-19 per month in each year

```{r}
Deaths_and_cases_each_month <- Final2 %>% group_by (Year,Month) %>% summarize(Avg_Deaths = mean(DEATH_COUNT),Avg_Cases = mean(CASE_COUNT), .groups = 'drop')

ggplot(Deaths_and_cases_each_month, aes(x = factor(Month), y=Avg_Deaths)) +
  geom_bar(stat = "identity", fill = "purple", alpha = 0.8) +
  labs(title = "Average Deaths Per Month for each year",
       x = "Month",
       y = "Deaths") +
  facet_wrap(~Year) 
                                              ggplot(Deaths_and_cases_each_month, aes(x = factor(Month), y=Avg_Cases)) +
  geom_bar(stat = "identity", fill = "purple", alpha = 0.8) +
  labs(title = "Average Cases Per Month for each year",
       x = "Month",
       y = "Cases") +
  facet_wrap(~Year) 


```
